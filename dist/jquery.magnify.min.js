/*!
 *  __  __    _    ____ _   _ ___ _______   __
 * |  \/  |  / \  / ___| \ | |_ _|  ___\ \ / /
 * | |\/| | / _ \| |  _|  \| || || |_   \ V /
 * | |  | |/ ___ \ |_| | |\  || ||  _|   | |
 * |_|  |_/_/   \_\____|_| \_|___|_|     |_|
 *
 * jquery.magnify - v1.6.1
 * A jQuery plugin to view images just like in windows
 * https://github.com/nzbin/magnify#readme
 *
 * Copyright (c) 2017 nzbin
 * Released under the MIT License
 */
!function(t){"function"==typeof define&&define.amd?define(["jquery"],t):"object"==typeof exports?t(require("jquery")):t(jQuery)}(function(P){"use strict";function o(t){return P(t).attr("data-src")?P(t).attr("data-src"):P(t).attr("href")}function y(t,i,e,a){var s=a?t.h:t.w,o=a?t.w:t.h;(o>i.h||s>i.w)&&e.addClass("is-grab"),o<=i.h&&s<=i.w&&e.removeClass("is-grab")}function t(){return"ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch}function Y(){return"Microsoft Internet Explorer"==navigator.appName&&0<navigator.appVersion.indexOf("MSIE 8.0")||"Microsoft Internet Explorer"==navigator.appName&&0<navigator.appVersion.indexOf("MSIE 7.0")}function a(t,i){this.options=P.extend(!0,{},r,i),i&&P.isArray(i.footerToolbar)&&(this.options.footerToolbar=i.footerToolbar),i&&P.isArray(i.headerToolbar)&&(this.options.headerToolbar=i.headerToolbar),this.$el=P(t),this.isOpened=!1,this.isMaximized=!1,this.isRotated=!1,this.rotateAngle=0,this.isDoResize=!1,this.imageData={},this.modalData={width:null,height:null,left:null,top:null},this.init(t,this.options)}var p=P(window),x=P(document),s="click",e="resize",n="keydown",h="wheel mousewheel DOMMouseScroll",w=t()?"touchstart":"mousedown",b=t()?"touchmove":"mousemove",z=t()?"touchend":"mouseup",$=".magnify",r={draggable:!0,resizable:!0,movable:!0,keyboard:!0,title:!0,modalWidth:320,modalHeight:320,fixedContent:!0,fixedModalSize:!1,initMaximized:!1,gapThreshold:.02,ratioThreshold:.1,minRatio:.05,maxRatio:16,headerToolbar:["maximize","close"],footerToolbar:["zoomIn","zoomOut","prev","fullscreen","next","actualSize","rotateRight"],icons:{minimize:'<svg viewBox="0 0 1024 1024" class="svg-inline-icon">          <path fill="currentColor" d="M1024 749.714v109.714c0 50.286-41.143 91.429-91.429 91.429          h-841.143c-50.286 0-91.429-41.143-91.429-91.429v-109.714c0-50.286 41.143-91.429 91.429          -91.429h841.143c50.286 0 91.429 41.143 91.429 91.429z"></path>        </svg>',maximize:'<svg viewBox="0 0 1024 1024" class="svg-inline-icon">          <path fill="currentColor" d="M146.286 804.571h731.429v-438.857h-731.429v438.857z          M1024 164.571v694.857c0 50.286-41.143 91.429-91.429 91.429h-841.143c-50.286 0          -91.429-41.143-91.429-91.429v-694.857c0-50.286 41.143-91.429 91.429-91.429          h841.143c50.286 0 91.429 41.143 91.429 91.429z"></path>        </svg>',close:'<svg viewBox="0 0 804.5714285714286 1024" class="svg-inline-icon">          <path fill="currentColor" d="M741.714 755.429c0 14.286-5.714 28.571-16 38.857          l-77.714 77.714c-10.286 10.286-24.571 16-38.857 16s-28.571-5.714-38.857-16l-168-168          -168 168c-10.286 10.286-24.571 16-38.857 16s-28.571-5.714-38.857-16l-77.714-77.714          c-10.286-10.286-16-24.571-16-38.857s5.714-28.571 16-38.857l168-168-168-168c-10.286-10.286          -16-24.571-16-38.857s5.714-28.571 16-38.857l77.714-77.714c10.286-10.286 24.571-16 38.857          -16s28.571 5.714 38.857 16l168 168 168-168c10.286-10.286 24.571-16 38.857-16          s28.571 5.714 38.857 16l77.714 77.714c10.286 10.286 16 24.571 16 38.857s-5.714 28.571          -16 38.857l-168 168 168 168c10.286 10.286 16 24.571 16 38.857z"></path>        </svg>',zoomIn:'<svg viewBox="0 0 950.8571428571428 1024" class="svg-inline-icon">          <path fill="currentColor" d="M585.143 457.143v36.571c0 9.714-8.571 18.286-18.286 18.286          h-128v128c0 9.714-8.571 18.286-18.286 18.286h-36.571c-9.714 0-18.286-8.571-18.286-18.286          v-128h-128c-9.714 0-18.286-8.571-18.286-18.286v-36.571c0-9.714 8.571-18.286 18.286-18.286          h128v-128c0-9.714 8.571-18.286 18.286-18.286h36.571c9.714 0 18.286 8.571 18.286 18.286          v128h128c9.714 0 18.286 8.571 18.286 18.286zM658.286 475.429c0-141.143-114.857-256-256          -256s-256 114.857-256 256 114.857 256 256 256 256-114.857 256-256zM950.857 950.857          c0 40.571-32.571 73.143-73.143 73.143-19.429 0-38.286-8-51.429-21.714l-196-195.429          c-66.857 46.286-146.857 70.857-228 70.857-222.286 0-402.286-180-402.286-402.286s180          -402.286 402.286-402.286 402.286 180 402.286 402.286c0 81.143-24.571 161.143-70.857 228          l196 196c13.143 13.143 21.143 32 21.143 51.429z"></path>        </svg>',zoomOut:'<svg viewBox="0 0 950.8571428571428 1024" class="svg-inline-icon">          <path fill="currentColor" d="M585.143 457.143v36.571c0 9.714-8.571 18.286-18.286 18.286          h-329.143c-9.714 0-18.286-8.571-18.286-18.286v-36.571c0-9.714 8.571-18.286 18.286-18.286          h329.143c9.714 0 18.286 8.571 18.286 18.286zM658.286 475.429c0-141.143-114.857-256-256          -256s-256 114.857-256 256 114.857 256 256 256 256-114.857 256-256zM950.857 950.857          c0 40.571-32.571 73.143-73.143 73.143-19.429 0-38.286-8-51.429-21.714l-196-195.429          c-66.857 46.286-146.857 70.857-228 70.857-222.286 0-402.286-180-402.286-402.286s180          -402.286 402.286-402.286 402.286 180 402.286 402.286c0 81.143-24.571 161.143-70.857 228          l196 196c13.143 13.143 21.143 32 21.143 51.429z"></path>        </svg>',prev:'<svg viewBox="0 0 914.2857142857142 1024" class="svg-inline-icon">          <path fill="currentColor" d="M877.714 512v73.143c0 38.857-25.714 73.143-66.857 73.143          h-402.286l167.429 168c13.714 13.143 21.714 32 21.714 51.429s-8 38.286-21.714 51.429          l-42.857 43.429c-13.143 13.143-32 21.143-51.429 21.143s-38.286-8-52-21.143l-372-372.571          c-13.143-13.143-21.143-32-21.143-51.429s8-38.286 21.143-52l372-371.429c13.714          -13.714 32.571-21.714 52-21.714s37.714 8 51.429 21.714l42.857 42.286          c13.714 13.714 21.714 32.571 21.714 52s-8 38.286-21.714 52l-167.429 167.429h402.286          c41.143 0 66.857 34.286 66.857 73.143z"></path>        </svg>',next:'<svg viewBox="0 0 841.1428571428571 1024" class="svg-inline-icon">          <path fill="currentColor" d="M841.143 548.571c0 19.429-7.429 38.286-21.143 52l-372 372          c-13.714 13.143-32.571 21.143-52 21.143s-37.714-8-51.429-21.143l-42.857-42.857c-13.714          -13.714-21.714-32.571-21.714-52s8-38.286 21.714-52l167.429-167.429h-402.286c-41.143 0          -66.857-34.286-66.857-73.143v-73.143c0-38.857 25.714-73.143 66.857-73.143h402.286          l-167.429-168c-13.714-13.143-21.714-32-21.714-51.429s8-38.286 21.714-51.429l42.857          -42.857c13.714-13.714 32-21.714 51.429-21.714s38.286 8 52 21.714l372 372          c13.714 13.143 21.143 32 21.143 51.429z"></path>        </svg>',fullscreen:'<svg viewBox="0 0 1097.142857142857 1024" class="svg-inline-icon">          <path fill="currentColor" d="M365.714 329.143c0 60.571-49.143 109.714-109.714 109.714          s-109.714-49.143-109.714-109.714 49.143-109.714 109.714          -109.714 109.714 49.143 109.714 109.714zM950.857 548.571v256h-804.571v-109.714l182.857          -182.857 91.429 91.429 292.571-292.571zM1005.714 146.286h-914.286c-9.714 0-18.286 8.571          -18.286 18.286v694.857c0 9.714 8.571 18.286 18.286 18.286h914.286c9.714 0 18.286          -8.571 18.286-18.286v-694.857c0-9.714-8.571-18.286-18.286-18.286zM1097.143 164.571          v694.857c0 50.286-41.143 91.429-91.429 91.429h-914.286c-50.286 0-91.429-41.143-91.429          -91.429v-694.857c0-50.286 41.143-91.429 91.429-91.429h914.286          c50.286 0 91.429 41.143 91.429 91.429z"></path>        </svg>',actualSize:'<svg viewBox="0 0 877.7142857142857 1024" class="svg-inline-icon">          <path fill="currentColor" d="M733.143 309.143l-202.857 202.857 202.857 202.857 82.286          -82.286c10.286-10.857 26.286-13.714 40-8 13.143 5.714 22.286 18.857 22.286 33.714v256          c0 20-16.571 36.571-36.571 36.571h-256c-14.857 0-28-9.143-33.714-22.857-5.714-13.143          -2.857-29.143 8-39.429l82.286-82.286-202.857-202.857-202.857 202.857 82.286 82.286          c10.857 10.286 13.714 26.286 8 39.429-5.714 13.714-18.857 22.857-33.714 22.857h-256          c-20 0-36.571-16.571-36.571-36.571v-256c0-14.857 9.143-28 22.857-33.714 13.143          -5.714 29.143-2.857 39.429 8l82.286 82.286 202.857-202.857-202.857-202.857-82.286 82.286          c-6.857 6.857-16 10.857-25.714 10.857-4.571 0-9.714-1.143-13.714-2.857-13.714-5.714          -22.857-18.857-22.857-33.714v-256c0-20 16.571-36.571 36.571-36.571h256          c14.857 0 28 9.143 33.714 22.857 5.714 13.143 2.857 29.143-8 39.429          l-82.286 82.286 202.857 202.857 202.857-202.857-82.286-82.286c-10.857-10.286-13.714          -26.286-8-39.429 5.714-13.714 18.857-22.857 33.714-22.857h256          c20 0 36.571 16.571 36.571 36.571v256c0 14.857-9.143 28-22.286 33.714-4.571 1.714          -9.714 2.857-14.286 2.857-9.714 0-18.857-4-25.714-10.857z"></path>        </svg>',rotateLeft:'<svg viewBox="0 0 877.7142857142857 1024" class="svg-inline-icon">          <path fill="currentColor" d="M877.714 512c0 241.714-197.143 438.857-438.857 438.857          -130.857 0-254.286-57.714-337.714-158.286-5.714-7.429-5.143-18.286 1.143-24.571l78.286          -78.857c4-3.429 9.143-5.143 14.286          -5.143 5.143 0.571 10.286 2.857 13.143 6.857 56 72.571 140 113.714 230.857 113.714 161.143 0 292.571          -131.429 292.571-292.571s-131.429-292.571-292.571-292.571c-74.857 0-145.714 28.571          -198.857 78.286l78.286 78.857c10.857 10.286 13.714 26.286 8 39.429-5.714 13.714          -18.857 22.857-33.714 22.857h-256c-20 0-36.571-16.571-36.571-36.571v-256          c0-14.857 9.143-28 22.857-33.714 13.143-5.714 29.143-2.857 39.429 8l74.286 73.714          c80.571-76 189.714-121.143 302.286-121.143 241.714 0 438.857 197.143 438.857 438.857z"></path>        </svg>',rotateRight:'<svg viewBox="0 0 877.7142857142857 1024" class="svg-inline-icon">          <path fill="currentColor" d="M877.714 146.286v256c0 20-16.571 36.571-36.571 36.571h-256          c-14.857 0-28-9.143-33.714-22.857-5.714-13.143-2.857-29.143 8-39.429l78.857-78.857          c-53.714-49.714-124.571-78.286-199.429-78.286-161.143 0-292.571 131.429-292.571 292.571          s131.429 292.571 292.571 292.571c90.857 0 174.857-41.143 230.857-113.714 2.857-4 8          -6.286 13.143-6.857 5.143 0 10.286 1.714 14.286 5.143l78.286 78.857          c6.857 6.286 6.857 17.143 1.143 24.571-83.429 100.571-206.857 158.286-337.714 158.286          -241.714 0-438.857-197.143-438.857-438.857s197.143-438.857 438.857-438.857          c112.571 0 221.714 45.143 302.286 121.143l74.286-73.714c10.286-10.857 26.286-13.714 40          -8 13.143 5.714 22.286 18.857 22.286 33.714z"></path>        </svg>'},i18n:{minimize:"minimize",maximize:"maximize",close:"close",zoomIn:"zoom-in(+)",zoomOut:"zoom-out(-)",prev:"prev(←)",next:"next(→)",fullscreen:"fullscreen",actualSize:"actual-size(Ctrl+Alt+0)",rotateLeft:"rotate-left(Ctrl+,)",rotateRight:"rotate-right(Ctrl+.)"},multiInstances:!0,initEvent:"click",initAnimation:!0,fixedModalPos:!1,zIndex:1090,dragHandle:!1,callbacks:{beforeOpen:P.noop,opened:P.noop,beforeClose:P.noop,closed:P.noop,beforeChange:P.noop,changed:P.noop},progressiveLoading:!0,customButtons:{}},M={isMoving:!1,isResizing:!1,zIndex:r.zIndex},l=null;a.prototype={init:function(t,i){var e=o(t);this.groupName=null;var a=P(t).attr("data-group"),s=x.find('[data-group="'+a+'"]');void 0!==a?(this.groupName=a,this.getImageGroup(s,e)):this.getImageGroup(l.not("[data-group]"),e),this.open(),this.loadImage(e),i.draggable&&this.draggable(this.$magnify,this.dragHandle,".magnify-button"),i.movable&&this.movable(this.$stage,Y()?".magnify-image":this.$image),i.resizable&&this.resizable(this.$magnify,this.$stage,Y()?".magnify-image":this.$image,i.modalWidth,i.modalHeight)},_createBtns:function(t){var e=this,a=["minimize","maximize","close","zoomIn","zoomOut","prev","next","fullscreen","actualSize","rotateLeft","rotateRight"],s="";return P.each(t,function(t,i){0<=P.inArray(i,a)?s+='<button class="magnify-button magnify-button-'+i+'" title="'+e.options.i18n[i]+'">'+e.options.icons[i]+"</button>":e.options.customButtons[i]&&(s+='<button class="magnify-button magnify-button-'+i+'" title="'+(e.options.customButtons[i].title||"")+'">'+e.options.customButtons[i].text+"</button>")}),s},_createTitle:function(){return this.options.title?'<div class="magnify-title"></div>':""},_createTemplate:function(){return'<div class="magnify-modal">        <div class="magnify-header">          <div class="magnify-toolbar">'+this._createBtns(this.options.headerToolbar)+"          </div>"+this._createTitle()+'        </div>        <div class="magnify-stage">          <img class="magnify-image" src="" alt="" />        </div>        <div class="magnify-footer">          <div class="magnify-toolbar">'+this._createBtns(this.options.footerToolbar)+"          </div>        </div>      </div>"},build:function(){var t=this._createTemplate(),i=P(t);this.$magnify=i,this.$stage=i.find(".magnify-stage"),this.$title=i.find(".magnify-title"),this.$image=i.find(".magnify-image"),this.$close=i.find(".magnify-button-close"),this.$maximize=i.find(".magnify-button-maximize"),this.$minimize=i.find(".magnify-button-minimize"),this.$zoomIn=i.find(".magnify-button-zoomIn"),this.$zoomOut=i.find(".magnify-button-zoomOut"),this.$actualSize=i.find(".magnify-button-actualSize"),this.$fullscreen=i.find(".magnify-button-fullscreen"),this.$rotateLeft=i.find(".magnify-button-rotateLeft"),this.$rotateRight=i.find(".magnify-button-rotateRight"),this.$prev=i.find(".magnify-button-prev"),this.$next=i.find(".magnify-button-next"),this.$stage.addClass("stage-ready"),this.$image.addClass("image-ready"),this.$magnify.css("z-index",M.zIndex),this.options.dragHandle&&".magnify-modal"!==this.options.dragHandle?this.dragHandle=this.$magnify.find(this.options.dragHandle):this.dragHandle=this.$magnify,P("body").append(this.$magnify),this._addEvents(),this._addCustomButtonEvents()},open:function(){var t;this._triggerHook("beforeOpen",this),this.options.multiInstances||P(".magnify-modal").eq(0).remove(),!P(".magnify-modal").length&&this.options.fixedContent&&(P("html").css({overflow:"hidden"}),document.body.scrollHeight>(window.innerHeight||document.documentElement.clientHeight)&&((t=function(){var t=document.createElement("div");t.style.cssText="width: 99px; height: 99px; overflow: scroll; position: absolute; top: -9999px;",document.body.appendChild(t);var i=t.offsetWidth-t.clientWidth;return document.body.removeChild(t),i}())&&P("html").css({"padding-right":t}))),this.build(),this.setModalPos(this.$magnify),this._triggerHook("opened",this)},close:function(t){this._triggerHook("beforeClose",this),this.$magnify.remove(),this.isOpened=!1,this.isMaximized=!1,this.isRotated=!1,this.rotateAngle=0;var i=!P(".magnify-modal").length;i&&this.options.fixedContent&&P("html").css({overflow:"","padding-right":""}),i&&this.options.multiInstances&&(M.zIndex=this.options.zIndex),P(".magnify-modal").length||(x.off(n+$),p.off(e+$)),this._triggerHook("closed",this)},setModalPos:function(t){var i=p.width(),e=p.height(),a=x.scrollLeft(),s=x.scrollTop(),o=this.options.modalWidth,n=this.options.modalHeight;this.options.initMaximized?(t.addClass("magnify-maximize"),t.css({width:"100%",height:"100%",left:0,top:0}),this.isOpened=!0,this.isMaximized=!0):t.css({width:o,height:n,left:(i-o)/2+a+"px",top:(e-n)/2+s+"px"})},setModalSize:function(t){var i=this,e=p.width(),a=p.height(),s=x.scrollLeft(),o=x.scrollTop(),n={left:this.$stage.css("left"),right:this.$stage.css("right"),top:this.$stage.css("top"),bottom:this.$stage.css("bottom"),borderLeft:this.$stage.css("border-left-width"),borderRight:this.$stage.css("border-right-width"),borderTop:this.$stage.css("border-top-width"),borderBottom:this.$stage.css("border-bottom-width")},h=t.width+parseFloat(n.left)+parseFloat(n.right)+parseFloat(n.borderLeft)+parseFloat(n.borderRight),r=t.height+parseFloat(n.top)+parseFloat(n.bottom)+parseFloat(n.borderTop)+parseFloat(n.borderBottom),l=(0<this.options.gapThreshold?this.options.gapThreshold:0)+1,g=Math.min(e/(h*l),a/(r*l),1),c=Math.max(h*g,this.options.modalWidth),m=Math.max(r*g,this.options.modalHeight),d={width:(c=this.options.fixedModalSize?this.options.modalWidth:Math.round(c))+"px",height:(m=this.options.fixedModalSize?this.options.modalHeight:Math.round(m))+"px",left:(e-c)/2+s+"px",top:(a-m)/2+o+"px"};this.options.initAnimation?this.$magnify.animate(d,function(){i.setImageSize(t)}):(this.$magnify.css(d),this.setImageSize(t)),this.isOpened=!0},getImageScaleToStage:function(t,i){return this.isRotated?Math.min(t/this.img.height,i/this.img.width,1):Math.min(t/this.img.width,i/this.img.height,1)},setImageSize:function(t){var i=Y()?this.$stage.find(".magnify-image"):this.$image,e={w:this.$stage.width(),h:this.$stage.height()},a=this.getImageScaleToStage(e.w,e.h);i.css({width:Math.ceil(t.width*a)+"px",height:Math.ceil(t.height*a)+"px",left:(e.w-Math.ceil(t.width*a))/2+"px",top:(e.h-Math.ceil(t.height*a))/2+"px"}),Y()&&i.find("group").css({width:Math.floor(t.width*a)+"px",height:Math.floor(t.height*a)+"px"}),P.extend(this.imageData,{initWidth:t.width*a,initHeight:t.height*a,initLeft:(e.w-t.width*a)/2,initTop:(e.h-t.height*a)/2,width:t.width*a,height:t.height*a,left:(e.w-t.width*a)/2,top:(e.h-t.height*a)/2}),y({w:i.width(),h:i.height()},{w:this.$stage.width(),h:this.$stage.height()},this.$stage,this.isRotated),this.imageLoaded||(this.$magnify.find(".magnify-loader").remove(),this.$stage.removeClass("stage-ready"),this.$image.removeClass("image-ready"),this.options.initAnimation&&!this.options.progressiveLoading&&i.fadeIn(),this.imageLoaded=!0)},loadImage:function(t,i,e){var a,s,o,n,h=this;this.$image.removeAttr("style").attr("src",""),this.isRotated=!1,this.rotateAngle=0,this.imageLoaded=!1,this.$magnify.append('<div class="magnify-loader"></div>'),this.$stage.addClass("stage-ready"),this.$image.addClass("image-ready"),this.options.initAnimation&&!this.options.progressiveLoading&&this.$image.hide(),Y()?this.$stage.html('<img class="magnify-image" id="magnify-image" src="'+t+'" alt="" />'):this.$image.attr("src",t),a=t,s=function(t){h.img=t,h.imageData={originalWidth:t.width,originalHeight:t.height},h.isMaximized||h.isOpened&&h.options.fixedModalPos?h.setImageSize(t):h.setModalSize(t),i&&i.call()},o=function(){h.$magnify.find(".magnify-loader").remove(),e&&e.call()},(n=new Image).onload=function(){s(n)},n.onerror=function(){o(n)},n.src=a,this.options.title&&this.setImageTitle(t)},getImageGroup:function(t,a){var s=this;s.groupData=[],P(t).each(function(t,i){var e=o(this);s.groupData.push({src:e,caption:P(this).attr("data-caption")}),a===e&&(s.groupIndex=t)})},setImageTitle:function(t){var i=this.groupData[this.groupIndex].caption||t.replace(/^.*?\/*([^/?]*)\.[a-z]+(\?.+|$)/gi,"$1");this.$title.html(i)},jump:function(t){this._triggerHook("beforeChange",[this,this.groupIndex]),this.groupIndex=this.groupIndex+t,this.jumpTo(this.groupIndex)},jumpTo:function(t){var i=this;0<=(t%=this.groupData.length)?t%=this.groupData.length:t<0&&(t=(this.groupData.length+t)%this.groupData.length),this.groupIndex=t,this.loadImage(this.groupData[t].src,function(){i._triggerHook("changed",[i,t])},function(){i._triggerHook("changed",[i,t])})},wheel:function(t){t.preventDefault();var i=1;t.originalEvent.deltaY?i=0<t.originalEvent.deltaY?1:-1:t.originalEvent.wheelDelta?i=-t.originalEvent.wheelDelta/120:t.originalEvent.detail&&(i=0<t.originalEvent.detail?1:-1);var e=-i*this.options.ratioThreshold,a={x:t.originalEvent.clientX-this.$stage.offset().left+x.scrollLeft(),y:t.originalEvent.clientY-this.$stage.offset().top+x.scrollTop()};this.zoom(e,a,t)},zoom:function(t,i,e){this.$image=Y()?this.$stage.find(".magnify-image"):this.$image,t=t<0?1/(1-t):1+t,(t=this.$image.width()/this.imageData.originalWidth*t)>this.options.maxRatio||t<this.options.minRatio||this.zoomTo(t,i,e)},zoomTo:function(t,i,e){var a=Y()?this.$stage.find(".magnify-image"):this.$image,s=this.$stage,o=this.imageData.width,n=this.imageData.height,h=this.imageData.left,r=this.imageData.top,l={w:s.width(),h:s.height(),x:s.offset().left,y:s.offset().top},g=this.imageData.originalWidth*t,c=this.imageData.originalHeight*t,m=i.x-(i.x-h)/o*g,d=i.y-(i.y-r)/n*c,p=this.isRotated?(g-c)/2:0,f=this.isRotated?c:g,u=this.isRotated?g:c,v=l.w-g,_=l.h-c,d=u<=l.h?(l.h-c)/2:p<d?p:_-p<d?d:_-p,m=f<=l.w?(l.w-g)/2:-p<m?-p:v+p<m?m:v+p;Math.abs(this.imageData.initWidth-g)<.05*this.imageData.initWidth?this.setImageSize(this.img):(a.css({width:Math.round(g)+"px",height:Math.round(c)+"px",left:Math.round(m)+"px",top:Math.round(d)+"px"}),Y()&&a.find("group").css({width:Math.ceil(g)+"px",height:Math.ceil(c)+"px"}),y({w:Math.round(f),h:Math.round(u)},{w:l.w,h:l.h},this.$stage)),P.extend(this.imageData,{width:g,height:c,left:m,top:d})},rotate:function(t){this.rotateAngle=this.rotateAngle+t,this.rotateAngle/90%2==0?this.isRotated=!1:this.isRotated=!0,this.rotateTo(this.rotateAngle)},rotateTo:function(t){(Y()?this.$stage.find(".magnify-image"):this.$image).rotate({angle:t}),this.setImageSize({width:this.imageData.originalWidth,height:this.imageData.originalHeight}),this.$stage.removeClass("is-grab")},resize:function(){var e,a,s,t=this;return e=function(){t.isOpened&&(t.isMaximized?t.setImageSize({width:t.imageData.originalWidth,height:t.imageData.originalHeight}):t.setModalSize({width:t.imageData.originalWidth,height:t.imageData.originalHeight}))},a=500,s=null,function(){var t=this,i=arguments;clearTimeout(s),s=setTimeout(function(){e.apply(t,i)},a)}},maximize:function(){var t,i;this.isMaximized?(this.$magnify.removeClass("magnify-maximize"),t=(p.width()-this.options.modalWidth)/2+x.scrollLeft(),i=(p.height()-this.options.modalHeight)/2+x.scrollTop(),this.$magnify.css({width:this.modalData.width?this.modalData.width:this.options.modalWidth,height:this.modalData.height?this.modalData.height:this.options.modalHeight,left:this.modalData.left?this.modalData.left:t,top:this.modalData.top?this.modalData.top:i}),this.isMaximized=!1):(this.modalData={width:this.$magnify.width(),height:this.$magnify.height(),left:this.$magnify.offset().left,top:this.$magnify.offset().top},this.$magnify.addClass("magnify-maximize"),this.$magnify.css({width:"100%",height:"100%",left:0,top:0}),this.isMaximized=!0),this.setImageSize({width:this.imageData.originalWidth,height:this.imageData.originalHeight})},fullscreen:function(){var t;(t=this.$magnify[0]).requestFullscreen?t.requestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullscreen?t.webkitRequestFullscreen():t.msRequestFullscreen&&t.msRequestFullscreen()},_keydown:function(t){var i=this;if(!this.options.keyboard)return!1;var e=t.keyCode||t.which||t.charCode,a=t.ctrlKey||t.metaKey,s=t.altKey||t.metaKey;switch(e){case 37:i.jump(-1);break;case 39:i.jump(1);break;case 187:i.zoom(3*i.options.ratioThreshold,{x:i.$stage.width()/2,y:i.$stage.height()/2},t);break;case 189:i.zoom(3*-i.options.ratioThreshold,{x:i.$stage.width()/2,y:i.$stage.height()/2},t);break;case 61:i.zoom(3*i.options.ratioThreshold,{x:i.$stage.width()/2,y:i.$stage.height()/2},t);break;case 173:i.zoom(3*-i.options.ratioThreshold,{x:i.$stage.width()/2,y:i.$stage.height()/2},t);break;case 48:a&&s&&i.zoomTo(1,{x:i.$stage.width()/2,y:i.$stage.height()/2},t);break;case 188:a&&i.rotate(-90);break;case 190:a&&i.rotate(90);break;case 81:this.close()}},_addEvents:function(){var i=this;this.$close.off(s+$).on(s+$,function(t){i.close()}),this.$stage.off(h+$).on(h+$,function(t){i.wheel(t)}),this.$zoomIn.off(s+$).on(s+$,function(t){i.zoom(3*i.options.ratioThreshold,{x:i.$stage.width()/2,y:i.$stage.height()/2},t)}),this.$zoomOut.off(s+$).on(s+$,function(t){i.zoom(3*-i.options.ratioThreshold,{x:i.$stage.width()/2,y:i.$stage.height()/2},t)}),this.$actualSize.off(s+$).on(s+$,function(t){i.zoomTo(1,{x:i.$stage.width()/2,y:i.$stage.height()/2},t)}),this.$prev.off(s+$).on(s+$,function(){i.jump(-1)}),this.$fullscreen.off(s+$).on(s+$,function(){i.fullscreen()}),this.$next.off(s+$).on(s+$,function(){i.jump(1)}),this.$rotateLeft.off(s+$).on(s+$,function(){i.rotate(-90)}),this.$rotateRight.off(s+$).on(s+$,function(){i.rotate(90)}),this.$maximize.off(s+$).on(s+$,function(){i.maximize()}),x.off(n+$).on(n+$,function(t){i._keydown(t)}),p.on(e+$,i.resize())},_addCustomButtonEvents:function(){var i,e=this;for(i in e.options.customButtons)this.$magnify.find(".magnify-button-"+i).off(s+$).on(s+$,function(t){e.options.customButtons[i].click.apply(e,[e,t])})},_triggerHook:function(t,i){this.options.callbacks[t]&&this.options.callbacks[t].apply(this,P.isArray(i)?i:[i])}},P.fn.magnify=function(i){for(var t in l=P(this),i)"string"!=typeof i[t]||isNaN(i[t])||(i[t]=parseFloat(i[t]));var e=P.extend(!0,{},r,i);return M.zIndex=e.zIndex,"string"==typeof i||("dblclick"===e.initEvent&&l.off("click"+$).on("click"+$,function(t){t.preventDefault(),t.stopPropagation()}),l.off(e.initEvent+$).on(e.initEvent+$,function(t){t.preventDefault(),t.stopPropagation(),P(this).data("magnify",new a(this,i))})),l},x.on(s+$,"[data-magnify]",function(t){l=P("[data-magnify]"),t.preventDefault(),P(this).data("magnify",new a(this,r))});P.extend(a.prototype,{draggable:function(o,t,i){var n=this,h=!1,r=0,l=0,g=0,c=0,e=function(t){var i,e,a,s;(t=t||window.event).preventDefault(),!h||M.isMoving||M.isResizing||n.isMaximized||(i="touchmove"===t.type?t.originalEvent.targetTouches[0].pageX:t.clientX,e="touchmove"===t.type?t.originalEvent.targetTouches[0].pageY:t.clientY,a=i-r,s=e-l,P(o).css({left:a+g+"px",top:s+c+"px"}))},a=function(t){x.off(b+$,e).off(z+$,a),h=!1};P(t).on(w+$,function(t){if(t=t||window.event,P(t.target).closest(i).length)return!0;n.options.multiInstances&&o.css("z-index",++M.zIndex),h=!0,r="touchstart"===t.type?t.originalEvent.targetTouches[0].pageX:t.clientX,l="touchstart"===t.type?t.originalEvent.targetTouches[0].pageY:t.clientY,g=P(o).offset().left,c=P(o).offset().top,x.on(b+$,e).on(z+$,a)})}});P.extend(a.prototype,{movable:function(r,l){var g=this,c=!1,m=0,d=0,p=0,f=0,u=0,v=0,_=0,n=function(t){(t=t||window.event).preventDefault();var i,e,a,s,o,n,h=Y()?P(r).find(l):P(l);c&&(i="touchmove"===t.type?t.originalEvent.targetTouches[0].pageX:t.clientX,e="touchmove"===t.type?t.originalEvent.targetTouches[0].pageY:t.clientY,o=(a=i-m)+p,n=(s=e-d)+f,0<v?_<s+f?n=_:s+f<-v+_&&(n=-v+_):n=f,0<u?-_<a+p?o=-_:a+p<-u-_&&(o=-u-_):o=p,h.css({left:o+"px",top:n+"px"}),P.extend(g.imageData,{left:o,top:n}))},h=function(t){x.off(b+$,n).off(z+$,h),c=!1,M.isMoving=!1,P("html, body, .magnify-modal, .magnify-stage, .magnify-button, .magnify-resizable-handle").removeClass("is-grabbing")};P(r).on(w+$,function(t){(t=t||window.event).preventDefault();var i=Y()?P(r).find(l):P(l),e=i.width(),a=i.height(),s=P(r).width(),o=P(r).height();m="touchstart"===t.type?t.originalEvent.targetTouches[0].pageX:t.clientX,d="touchstart"===t.type?t.originalEvent.targetTouches[0].pageY:t.clientY,_=g.isRotated?(e-a)/2:0,u=g.isRotated?a-s:e-s,v=g.isRotated?e-o:a-o,c=0<u||0<v,M.isMoving=0<u||0<v,p=i.position().left-(Y()?0:_),f=i.position().top+(Y()?0:_),r.hasClass("is-grab")&&P("html, body, .magnify-modal, .magnify-stage, .magnify-button, .magnify-resizable-handle").addClass("is-grabbing"),x.on(b+$,n).on(z+$,h)})}});P.extend(a.prototype,{resizable:function(C,S,D,I,E){var W=this,t=P('<div class="magnify-resizable-handle magnify-resizable-handle-e"></div>'),i=P('<div class="magnify-resizable-handle magnify-resizable-handle-w"></div>'),e=P('<div class="magnify-resizable-handle magnify-resizable-handle-s"></div>'),a=P('<div class="magnify-resizable-handle magnify-resizable-handle-n"></div>'),s=P('<div class="magnify-resizable-handle magnify-resizable-handle-se"></div>'),o=P('<div class="magnify-resizable-handle magnify-resizable-handle-sw"></div>'),n=P('<div class="magnify-resizable-handle magnify-resizable-handle-ne"></div>'),h=P('<div class="magnify-resizable-handle magnify-resizable-handle-nw"></div>'),r={e:t,w:i,s:e,n:a,se:s,sw:o,ne:n,nw:h};P(C).append(t,i,e,a,s,o,n,h);var l,O=!1,H=0,R=0,k={w:0,h:0,l:0,t:0},j={w:0,h:0,l:0,t:0},q=0,L=0,B=0,A="",g=function(t){(t=t||window.event).preventDefault();var i,e,a,s,o,n,h,r,l,g,c,m,d,p,f,u,v,_,y,x,w,b,z,$,M,T=Y()?P(S).find(D):P(D);O&&!W.isMaximized&&(i="touchmove"===t.type?t.originalEvent.targetTouches[0].pageX:t.clientX,e="touchmove"===t.type?t.originalEvent.targetTouches[0].pageY:t.clientY,w=A,z=s=e-R,$=-(b=a=i-H)+k.w>I?b+k.l:k.l+k.w-I,M=-z+k.h>E?z+k.t:k.t+k.h-E,o={e:{width:Math.max(b+k.w,I)+"px"},s:{height:Math.max(z+k.h,E)+"px"},se:{width:Math.max(b+k.w,I)+"px",height:Math.max(z+k.h,E)+"px"},w:{width:Math.max(-b+k.w,I)+"px",left:$+"px"},n:{height:Math.max(-z+k.h,E)+"px",top:M+"px"},nw:{width:Math.max(-b+k.w,I)+"px",height:Math.max(-z+k.h,E)+"px",top:M+"px",left:$+"px"},ne:{width:Math.max(b+k.w,I)+"px",height:Math.max(-z+k.h,E)+"px",top:M+"px"},sw:{width:Math.max(-b+k.w,I)+"px",height:Math.max(z+k.h,E)+"px",left:$+"px"}}[w],P(C).css(o),h=A,r=a,l=s,g=Y()?P(S).find(D):P(D),c=Y()?g.position().left+q:g.position().left,m=Y()?g.position().top-q:g.position().top,d=r+k.w>I?j.w-L+r-q:I-(k.w-j.w)-L-q,p=l+k.h>E?j.h-B+l+q:E-(k.h-j.h)-B+q,f=-r+k.w>I?j.w-L-r-q:I-(k.w-j.w)-L-q,u=-l+k.h>E?j.h-B-l+q:E-(k.h-j.h)-B+q,v=(0<d||c<0?c:0)-q,_=(0<p||m<0?m:0)+q,y=(0<f||c<0?c:0)-q,x=(0<u||m<0?m:0)+q,n={e:{left:-q<=d?(d-q)/2+"px":d<v?v+"px":d+"px"},s:{top:q<=p?(p+q)/2+"px":p<_?_+"px":p+"px"},se:{top:q<=p?(p+q)/2+"px":p<_?_+"px":p+"px",left:-q<=d?(d-q)/2+"px":d<v?v+"px":d+"px"},w:{left:-q<=f?(f-q)/2+"px":f<y?y+"px":f+"px"},n:{top:q<=u?(u+q)/2+"px":u<x?x+"px":u+"px"},nw:{top:q<=u?(u+q)/2+"px":u<x?x+"px":u+"px",left:-q<=f?(f-q)/2+"px":f<y?y+"px":f+"px"},ne:{top:q<=u?(u+q)/2+"px":u<x?x+"px":u+"px",left:-q<=d?(d-q)/2+"px":d<v?v+"px":d+"px"},sw:{top:q<=p?(p+q)/2+"px":p<_?_+"px":p+"px",left:-q<=f?(f-q)/2+"px":f<y?y+"px":f+"px"}}[h],T.css(n),W.isDoResize=!0)},c=function(t){x.off(b+$,g).off(z+$,c),M.isResizing&&y({w:L,h:B},{w:P(S).width(),h:P(S).height()},S),O=!1,M.isResizing=!1,P("html, body, .magnify-modal, .magnify-stage, .magnify-button").css("cursor","");var i=W.getImageScaleToStage(P(S).width(),P(S).height());P.extend(W.imageData,{initWidth:W.img.width*i,initHeight:W.img.height*i,initLeft:(P(S).width()-W.img.width*i)/2,initTop:(P(S).height()-W.img.height*i)/2})};P.each(r,function(i,t){t.on(w+$,function(t){!function(t,i){(i=i||window.event).preventDefault();var e=Y()?P(S).find(D):P(D);O=!0,M.isResizing=!0,H="touchstart"===i.type?i.originalEvent.targetTouches[0].pageX:i.clientX,R="touchstart"===i.type?i.originalEvent.targetTouches[0].pageY:i.clientY,k={w:P(C).width(),h:P(C).height(),l:P(C).offset().left,t:P(C).offset().top},j={w:P(S).width(),h:P(S).height(),l:P(S).offset().left,t:P(S).offset().top},l={w:e.width(),h:e.height(),l:e.position().left,t:e.position().top},q=W.isRotated?(l.w-l.h)/2:0,L=W.isRotated?l.h:l.w,B=W.isRotated?l.w:l.h,A=t,P("html,body,.magnify-modal,.magnify-stage,.magnify-button").css("cursor",t+"-resize"),x.on(b+$,g).on(z+$,c)}(i,t)})})}})}),function($){for(var supportedCSS,supportedCSSOrigin,styles=document.getElementsByTagName("head")[0].style,toCheck="transformProperty WebkitTransform OTransform msTransform MozTransform".split(" "),a=0,ef;a<toCheck.length;a++)void 0!==styles[toCheck[a]]&&(supportedCSS=toCheck[a]);supportedCSS&&(supportedCSSOrigin=supportedCSS.replace(/[tT]ransform/,"TransformOrigin"),"T"==supportedCSSOrigin[0]&&(supportedCSSOrigin[0]="t")),eval('IE = "v"=="\v"'),jQuery.fn.extend({rotate:function(t){if(0!==this.length&&void 0!==t){"number"==typeof t&&(t={angle:t});for(var i=[],e=0,a=this.length;e<a;e++){var s,o,n=this.get(e);n.Wilq32&&n.Wilq32.PhotoEffect?n.Wilq32.PhotoEffect._handleRotation(t):(s=$.extend(!0,{},t),o=new Wilq32.PhotoEffect(n,s)._rootObj,i.push($(o)))}return i}},getRotateAngle:function(){for(var t=[0],i=0,e=this.length;i<e;i++){var a=this.get(i);a.Wilq32&&a.Wilq32.PhotoEffect&&(t[i]=a.Wilq32.PhotoEffect._angle)}return t},stopRotate:function(){for(var t=0,i=this.length;t<i;t++){var e=this.get(t);e.Wilq32&&e.Wilq32.PhotoEffect&&clearTimeout(e.Wilq32.PhotoEffect._timer)}}}),Wilq32=window.Wilq32||{},Wilq32.PhotoEffect=supportedCSS?function(t,i){t.Wilq32={PhotoEffect:this},this._img=this._rootObj=this._eventObj=t,this._handleRotation(i)}:function(t,i){var e;this._img=t,this._onLoadDelegate=[i],this._rootObj=document.createElement("span"),this._rootObj.style.display="inline-block",this._rootObj.Wilq32={PhotoEffect:this},t.parentNode.insertBefore(this._rootObj,t),t.complete?this._Loader():jQuery((e=this)._img).bind("load",function(){e._Loader()})},Wilq32.PhotoEffect.prototype={_setupParameters:function(t){this._parameters=this._parameters||{},"number"!=typeof this._angle&&(this._angle=0),"number"==typeof t.angle&&(this._angle=t.angle),this._parameters.animateTo="number"==typeof t.animateTo?t.animateTo:this._angle,this._parameters.step=t.step||this._parameters.step||null,this._parameters.easing=t.easing||this._parameters.easing||this._defaultEasing,this._parameters.duration="duration"in t?t.duration:t.duration||this._parameters.duration||1e3,this._parameters.callback=t.callback||this._parameters.callback||this._emptyFunction,this._parameters.center=t.center||this._parameters.center||["50%","50%"],"string"==typeof this._parameters.center[0]?this._rotationCenterX=parseInt(this._parameters.center[0],10)/100*this._imgWidth*this._aspectW:this._rotationCenterX=this._parameters.center[0],"string"==typeof this._parameters.center[1]?this._rotationCenterY=parseInt(this._parameters.center[1],10)/100*this._imgHeight*this._aspectH:this._rotationCenterY=this._parameters.center[1],t.bind&&t.bind!=this._parameters.bind&&this._BindEvents(t.bind)},_emptyFunction:function(){},_defaultEasing:function(t,i,e,a,s){return-a*((i=i/s-1)*i*i*i-1)+e},_handleRotation:function(t,i){supportedCSS||this._img.complete||i?(this._setupParameters(t),this._angle==this._parameters.animateTo?this._rotate(this._angle):this._animateStart()):this._onLoadDelegate.push(t)},_BindEvents:function(t){if(t&&this._eventObj){if(this._parameters.bind){var i=this._parameters.bind;for(e in i)i.hasOwnProperty(e)&&jQuery(this._eventObj).unbind(e,i[e])}for(var e in this._parameters.bind=t)t.hasOwnProperty(e)&&jQuery(this._eventObj).bind(e,t[e])}},_Loader:IE?function(){var t,i=this._img.width,e=this._img.height;for(this._imgWidth=i,this._imgHeight=e,this._img.parentNode.removeChild(this._img),this._vimage=this.createVMLNode("image"),this._vimage.src=this._img.src,this._vimage.style.height=e+"px",this._vimage.style.width=i+"px",this._vimage.style.position="absolute",this._vimage.style.top="0px",this._vimage.style.left="0px",this._aspectW=this._aspectH=1,this._container=this.createVMLNode("group"),this._container.style.width=i,this._container.style.height=e,this._container.style.position="absolute",this._container.style.top="0px",this._container.style.left="0px",this._container.setAttribute("coordsize",i-1+","+(e-1)),this._container.appendChild(this._vimage),this._rootObj.appendChild(this._container),this._rootObj.style.position="relative",this._rootObj.style.width=i+"px",this._rootObj.style.height=e+"px",this._rootObj.setAttribute("id",this._img.getAttribute("id")),this._rootObj.className=this._img.className,this._eventObj=this._rootObj;t=this._onLoadDelegate.shift();)this._handleRotation(t,!0)}:function(){this._rootObj.setAttribute("id",this._img.getAttribute("id")),this._rootObj.className=this._img.className,this._imgWidth=this._img.naturalWidth,this._imgHeight=this._img.naturalHeight;var t,i=Math.sqrt(this._imgHeight*this._imgHeight+this._imgWidth*this._imgWidth);for(this._width=3*i,this._height=3*i,this._aspectW=this._img.offsetWidth/this._img.naturalWidth,this._aspectH=this._img.offsetHeight/this._img.naturalHeight,this._img.parentNode.removeChild(this._img),this._canvas=document.createElement("canvas"),this._canvas.setAttribute("width",this._width),this._canvas.style.position="relative",this._canvas.style.left=-this._img.height*this._aspectW+"px",this._canvas.style.top=-this._img.width*this._aspectH+"px",this._canvas.Wilq32=this._rootObj.Wilq32,this._rootObj.appendChild(this._canvas),this._rootObj.style.width=this._img.width*this._aspectW+"px",this._rootObj.style.height=this._img.height*this._aspectH+"px",this._eventObj=this._canvas,this._cnv=this._canvas.getContext("2d");t=this._onLoadDelegate.shift();)this._handleRotation(t,!0)},_animateStart:function(){this._timer&&clearTimeout(this._timer),this._animateStartTime=+new Date,this._animateStartAngle=this._angle,this._animate()},_animate:function(){var t,i,e=+new Date,a=e-this._animateStartTime>this._parameters.duration;a&&!this._parameters.animatedGif?clearTimeout(this._timer):((this._canvas||this._vimage||this._img)&&(t=this._parameters.easing(0,e-this._animateStartTime,this._animateStartAngle,this._parameters.animateTo-this._animateStartAngle,this._parameters.duration),this._rotate(~~(10*t)/10)),this._parameters.step&&this._parameters.step(this._angle),(i=this)._timer=setTimeout(function(){i._animate.call(i)},10)),this._parameters.callback&&a&&(this._angle=this._parameters.animateTo,this._rotate(this._angle),this._parameters.callback.call(this._rootObj))},_rotate:(ef=Math.PI/180,IE?function(t){this._angle=t,this._container.style.rotation=t%360+"deg",this._vimage.style.top=-(this._rotationCenterY-this._imgHeight/2)+"px",this._vimage.style.left=-(this._rotationCenterX-this._imgWidth/2)+"px",this._container.style.top=this._rotationCenterY-this._imgHeight/2+"px",this._container.style.left=this._rotationCenterX-this._imgWidth/2+"px"}:supportedCSS?function(t){this._angle=t,this._img.style[supportedCSS]="rotate("+t%360+"deg)",this._img.style[supportedCSSOrigin]=this._parameters.center.join(" ")}:function(t){t=(this._angle=t)%360*ef,this._canvas.width=this._width,this._canvas.height=this._height,this._cnv.translate(this._imgWidth*this._aspectW,this._imgHeight*this._aspectH),this._cnv.translate(this._rotationCenterX,this._rotationCenterY),this._cnv.rotate(t),this._cnv.translate(-this._rotationCenterX,-this._rotationCenterY),this._cnv.scale(this._aspectW,this._aspectH),this._cnv.drawImage(this._img,0,0)})},IE&&(Wilq32.PhotoEffect.prototype.createVMLNode=function(){document.createStyleSheet().addRule(".rvml","behavior:url(#default#VML)");try{return document.namespaces.rvml||document.namespaces.add("rvml","urn:schemas-microsoft-com:vml"),function(t){return document.createElement("<rvml:"+t+' class="rvml">')}}catch(t){return function(t){return document.createElement("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="rvml">')}}}())}(jQuery);